# #Making Labels for Q41_11 table
tableQ41_11 <- table(global_data$Q41_11,global_data$hcat)
tableQ41_11 <- as.matrix(tableQ41_11)
row.names(tableQ41_11)<-c('Did Not Select','Selected')
colnames(tableQ41_11) <-c('Normal','Mild','Moderate','Severe')
# #BarPlot
# barplot(tableQ41_11, main="Friends and Family",
#         xlab="Categories of Hearing Loss", col=c("red","blue"),
#         ylim=c(0,1000),
#         ylab = "Number of Participants",
#         legend = rownames(tableQ41_14), beside=TRUE)
#
global_data$Q41_12 <- global_data$q0041_0012
global_data$Q41_12[is.na(global_data$Q41_12)] <- 0
# #Making Labels for Q41_12 table
tableQ41_12 <- table(global_data$Q41_12,global_data$hcat)
tableQ41_12 <- as.matrix(tableQ41_12)
row.names(tableQ41_12)<-c('Did Not Select','Selected')
colnames(tableQ41_12) <-c('Normal','Mild','Moderate','Severe')
# #BarPlot
# barplot(tableQ41_12, main="Hearing Loss Associations/Charities",
#         xlab="Categories of Hearing Loss", col=c("red","blue"),
#         ylim=c(0,1000),
#         ylab = "Number of Participants",
#         legend = rownames(tableQ41_14), beside=TRUE)
#
global_data$Q41_13 <- global_data$q0041_0013
global_data$Q41_13[is.na(global_data$Q41_13)] <- 0
# #Making Labels for Q41_13 table
tableQ41_13 <- table(global_data$Q41_13,global_data$hcat)
tableQ41_13 <- as.matrix(tableQ41_13)
row.names(tableQ41_13)<-c('Did Not Select','Selected')
colnames(tableQ41_13) <-c('Normal','Mild','Moderate','Severe')
# #BarPlot
# barplot(tableQ41_13, main="Advertisements in Public Places",
#         xlab="Categories of Hearing Loss", col=c("red","blue"),
#         ylim=c(0,1000),
#         ylab = "Number of Participants",
#         legend = rownames(tableQ41_14), beside=TRUE)
#
global_data$Q41_14 <- global_data$q0041_0014
global_data$Q41_14[is.na(global_data$Q41_14)] <- 0
# #Making Labels for Q41_14 table
tableQ41_14 <- table(global_data$Q41_14,global_data$hcat)
tableQ41_14 <- as.matrix(tableQ41_14)
row.names(tableQ41_14)<-c('Did Not Select','Selected')
colnames(tableQ41_14) <-c('Normal','Mild','Moderate','Severe')
# #BarPlot
# barplot(tableQ41_14, main="Public Libraries",
#         xlab="Categories of Hearing Loss", col=c("red","blue"),
#         ylim=c(0,1000),
#         ylab = "Number of Participants",
#         legend = rownames(tableQ41_14), beside=TRUE)
# #makes a grid table
# grid.table(table(US_data$provider,US_data$hcat))
# (table(global_data$HAold,global_data$hcat))
#
# # Stacked Bar Plot with Colors and Legend (Copy and paste into console to have appear)
# barplot(tableQ41_14, main="Public Libraries",
#         xlab="Categories of Hearing Loss", col=c("red","blue"),
#         ylim=c(0,1000),
#         ylab = "Number of Participants",
#         legend = rownames(tableQ41_14))
#
# # Grouped Bar Plot(Copy and paste into the Console to have appear)
# barplot(tableQ41_14, main="Public Libraries",
#         xlab="Categories of Hearing Loss", col=c("red","blue"),
#         ylim=c(0,1000),
#         ylab = "Number of Participants",
#         legend = rownames(tableQ41_14), beside=TRUE)
#
# # Percentage BarPlot Example
#Reference Example For Barplot
global_data$Q41_14 <- global_data$q0041_0014
global_data$Q41_14[is.na(global_data$Q41_14)] <- 0
#Making Labels for Q41_14 table
tableQ41_14 <- table(global_data$Q41_14,global_data$hcat)
tableQ41_14 <- as.matrix(tableQ41_14)
row.names(tableQ41_14)<-c('Did Not Select','Selected')
colnames(tableQ41_14) <-c('Normal','Mild','Moderate','Severe')
#BarPlot
barplot(tableQ41_14, main="Public Libraries",
xlab="Categories of Hearing Loss", col=c("red","blue"),
ylim=c(0,1000),
ylab = "Number of Participants",
legend = rownames(tableQ41_14), beside=TRUE)
#OBJ rename table columns and row.
#1. Assign table a name ("test)
test<-table(global_data$dpressure,global_data$hcat)
#2. Save "test" as a matrix (as.matrix(test))
test <- as.matrix(test)
#3. Select and assign row names
row.names(test)<-c('no','yes')
#4. Select and assign column names
colnames(test) <-c('normal','mild','mod','severe')
#5 Type "test" or grid.table(test) and it should all come together
grid.table(test)
test<-table(global_data$dpressure,global_data$hcat)
test <- as.matrix(test)
row.names(test)<-c('Did Not Select','Selected')
colnames(test) <-c('Normal','Mild','Moderate','Severe')
Q41 <- as.data.frame(table(global_data$Q41_1)[2])
Q41[2] <- table(global_data$Q41_2)[2]
Q41[3] <- table(global_data$Q41_3)[2]
Q41[4] <- table(global_data$Q41_4)[2]
Q41[5] <- table(global_data$Q41_5)[2]
Q41[6] <- table(global_data$Q41_6)[2]
Q41[7] <- table(global_data$Q41_7)[2]
Q41[8] <- table(global_data$Q41_8)[2]
Q41[9] <- table(global_data$Q41_9)[2]
Q41[10] <- table(global_data$Q41_10)[2]
Q41[11] <- table(global_data$Q41_11)[2]
Q41[12] <- table(global_data$Q41_12)[2]
Q41[13] <- table(global_data$Q41_13)[2]
Q41[14] <- table(global_data$Q41_14)[2]
Q41<-t(Q41)
Q41 <- as.data.frame(Q41)
Q41[,2] <- Q41
Q41[,1] <- c('Doctor','Pamphlets in HCP Office', 'Radio Ads', 'Newspaper', 'Mailed Pamphlets','TV Ads', 'University Websites', 'Internet Ads', 'Government Websites', 'Medical Websites', 'Friends and Family', 'Hearing Loss Associations_Charities', 'Ads in Public Places', 'Public Libraries')
names(Q41) <- c('Question','Responses')
Q41<-(Q41[order(-Q41$Responses),])
#Organizing Q41 Global In-Person Data into horizontal graph
ggplot(data=Q41, aes(x=Question,y=Responses)) +
geom_bar(,stat="identity") +
coord_flip()+
ggtitle("Q41 Global In-Person Data") +
scale_x_discrete(   limits=rev(c(t(Q41[1]))))
#Country Data Stratification.
data_stratify <- function(data){
data$Q41_1 <- data$q0041_0001
data$Q41_1[is.na(data$Q41_1)] <- 0
data$Q41_2 <- data$q0041_0002
data$Q41_2[is.na(data$Q41_2)] <- 0
data$Q41_3 <- data$q0041_0003
data$Q41_3[is.na(data$Q41_3)] <- 0
data$Q41_4 <- data$q0041_0004
data$Q41_4[is.na(data$Q41_4)] <- 0
data$Q41_5 <- data$q0041_0005
data$Q41_5[is.na(data$Q41_5)] <- 0
data$Q41_6 <- data$q0041_0006
data$Q41_6[is.na(data$Q41_6)] <- 0
data$Q41_7 <- data$q0041_0007
data$Q41_7[is.na(data$Q41_7)] <- 0
data$Q41_8 <- data$q0041_0008
data$Q41_8[is.na(data$Q41_8)] <- 0
data$Q41_9 <- data$q0041_0009
data$Q41_9[is.na(data$Q41_9)] <- 0
data$Q41_10 <- data$q0041_0010
data$Q41_10[is.na(data$Q41_10)] <- 0
data$Q41_11 <- data$q0041_0011
data$Q41_11[is.na(data$Q41_11)] <- 0
data$Q41_12 <- data$q0041_0012
data$Q41_12[is.na(data$Q41_12)] <- 0
data$Q41_13 <- data$q0041_0013
data$Q41_13[is.na(data$Q41_13)] <- 0
data$Q41_14 <- data$q0041_0014
data$Q41_14[is.na(data$Q41_14)] <- 0
return(data) }
US_data <- data_stratify(US_data)
UK_data <- data_stratify(UK_data)
CAN_data <- data_stratify(CAN_data)
AUS_data <- data_stratify(AUS_data)
#Graphing Q41 Function
Graph_Q41 <- function(data) {
Q41 <- as.data.frame(table(data$Q41_1)[2]/nrow(data)*100)
Q41[2] <- table(data$Q41_2)[2]/nrow(data)*100
Q41[3] <- table(data$Q41_3)[2]/nrow(data)*100
Q41[4] <- table(data$Q41_4)[2]/nrow(data)*100
Q41[5] <- table(data$Q41_5)[2]/nrow(data)*100
Q41[6] <- table(data$Q41_6)[2]/nrow(data)*100
Q41[7] <- table(data$Q41_7)[2]/nrow(data)*100
Q41[8] <- table(data$Q41_8)[2]/nrow(data)*100
Q41[9] <- table(data$Q41_9)[2]/nrow(data)*100
Q41[10] <- table(data$Q41_10)[2]/nrow(data)*100
Q41[11] <- table(data$Q41_11)[2]/nrow(data)*100
Q41[12] <- table(data$Q41_12)[2]/nrow(data)*100
Q41[13] <- table(data$Q41_13)[2]/nrow(data)*100
Q41[14] <- table(data$Q41_14)[2]/nrow(data)*100
Q41<-t(Q41)
Q41 <- as.data.frame(Q41)
Q41[,2] <- Q41
Q41[,1] <- c('Doctor','Pamphlets in HCP Office', 'Radio Ads', 'Newspaper', 'Mailed Pamphlets','TV Ads', 'University Websites', 'Internet Ads', 'Government Websites', 'Medical Websites', 'Friends and Family', 'Hearing Loss Associations/Charities', 'Ads in Public Places', 'Public Libraries')
names(Q41) <- c('Question','Responses')
Q41<-(Q41[order(-Q41$Responses),])
#Organizing Q41  In-Person Data into horizontal graph
Q41plot <- ggplot(data=Q41, aes(x=Question,y=Responses)) +
geom_bar(,stat="identity") +
coord_flip()+
scale_x_discrete(   limits=rev(c(t(Q41[1]))))+
scale_y_continuous (limits=c(0,100) )
return(Q41plot)
}
#Q41 Plotting individual countries
USQ41plot<-Graph_Q41(US_data)
USQ41plot + ggtitle("Q41 US In-Person Data")
USQ41plot +geom_text(aes(label=round(USQ41plot$data$Responses,2)),hjust=-.8)
UKQ41plot<-Graph_Q41(UK_data)
UKQ41plot + ggtitle("Q41 UK In-Person Data")
CANQ41plot<-Graph_Q41(CAN_data)
CANQ41plot + ggtitle("Q41 Canada In-Person Data")
AUSQ41plot<-Graph_Q41(AUS_data)
AUSQ41plot + ggtitle("Q41 Australia In-Person Data")
#stratifying hcat
global_1 <- global_data%>%filter(hcat==1)
global_2 <- global_data%>%filter(hcat==2)
global_3 <- global_data%>%filter(hcat==3)
global_4 <- global_data%>%filter(hcat==4)
hcat1Q41plot<-Graph_Q41(global_1)
hcat1Q41plot + ggtitle("Q41 Normal Hearing Data")
hcat2Q41plot<-Graph_Q41(global_2)
hcat2Q41plot + ggtitle("Q41 Mild Hearing Loss Data")
hcat3Q41plot<-Graph_Q41(global_3)
hcat3Q41plot + ggtitle("Q41 Moderate Hearing Loss Data")
hcat4Q41plot<-Graph_Q41(global_4)
hcat4Q41plot + ggtitle("Q41 Severe Hearing Loss Data")
#Sum of Responses (or responses per person)
global_1$q0041_0001
sum(global_1$q0041_0001)
sum(global_1[88:101],na.rm=T)/nrow(global_1)
sum(global_2[88:101],na.rm=T)/nrow(global_2)
sum(global_3[88:101],na.rm=T)/nrow(global_3)
sum(global_4[88:101],na.rm=T)/nrow(global_4)
sum(US_data[88:101],na.rm=T)/nrow(US_data)
sum(AUS_data[88:101],na.rm=T)/nrow(AUS_data)
sum(UK_data[92:105],na.rm=T)/nrow(UK_data)
sum(CAN_data[92:105],na.rm=T)/nrow(CAN_data)
## Stratify by NH, HL-HA, and HL +HA
global_NH <- global_data%>%filter(q0046 %in% c(1,2,3))
global_HL <- global_data%>%filter(q0046==4)
global_HLHA <- global_data%>%filter(q0046==5)
# Plot bar graph by hearing loss type
hear1plot<-Graph_Q41(global_NH)
hear1plot + ggtitle("Normal Hearing") +
geom_text(aes(label=round(hear1plot$data$Responses,2)),hjust=-.8)
hear2plot<-Graph_Q41(global_HL)
hear2plot + ggtitle("Hearing loss without hearing aid") +
geom_text(aes(label=round(hear2plot$data$Responses,2)),hjust=-.8)
hear3plot<-Graph_Q41(global_HLHA)
hear3plot + ggtitle("Hearing loss with hearing aid") +
geom_text(aes(label=round(hear3plot$data$Responses,2)),hjust=-.8)
table(global_data$q0002)
table(global_data$q0003)
table(global_data$region_id)
table(global_data$country_id)
View(global_data)
table(global_data$country)
table(global_data$country,global_data$q0002)
table(global_data$country,global_data$q0003)
table(global_data$country,global_data$pta)
table(global_data$country,global_data$BEPTA)
summarize(global_data$BEPTA)
summarise(global_data$BEPTA)
class(global_data$BEPTA)
median(global_data$BEPTA)
global_data %>% select(q0002,q0003,BEPTA,country) %>% group_by(country) %>% summarise(gender=median(q0002),age=median(q0003),PTA=median(BEPTA))
global_data %>% select(q0002,q0003,BEPTA,country) %>% group_by(country) %>% summarise(gender=mean(q0002),age=mean(q0003),PTA=mean(BEPTA))
global_data %>% select(q0002,q0003,BEPTA,country) %>% group_by(country) %>% summarise(gender=mean(q0002),age=mean(q0003),PTA=mean(BEPTA))
global_data %>% select(q0002,q0003,BEPTA,country) %>% group_by(country) %>% summarise(gender=mean(q0002),age=mean(q0003),PTA=mean(BEPTA))
global_data %>% select(q0002,q0003,BEPTA,country) %>% group_by(country) %>% summarise(q0002=mean(q0002),q0003=mean(q0003),BEPTA=mean(BEPTA))
cars <- mtcars %>%
select(cyl, mpg, hp, qsec) %>%
group_by(cyl) %>%
summarise(mpg = mean(mpg), hp = mean(hp), qsec = mean(qsec))
library("dplyr")
cars <- mtcars %>%
select(cyl, mpg, hp, qsec) %>%
group_by(cyl) %>%
summarise(mpg = mean(mpg), hp = mean(hp), qsec = mean(qsec))
median(global_data$BEPTA
)
median(global_data$BEPTA,na.rm=FALSE)
(global_data$BEPTA)
sum(global_data$BEPTA)
sum(global_data$BEPTA,na.rm=FALSE)
is.na(global_data$BEPTA,na.rm=FALSE)
is.na(global_data$BEPTA)
mean(global_data$BEPTA,na.rm=FALSE)
mean(global_data$BEPTA[1:100],na.rm=FALSE)
mean(global_data$BEPTA[1:10],na.rm=FALSE)
sum(global_data$BEPTA[1:10],na.rm=FALSE)
global_data$BEPTA[1:10]
global_data$BEPTA[1:5]
sum(global_data$BEPTA[1:5])
mean(global_data$BEPTA[1:5])
is.na(global_data$BEPTA[1:10])
median(global_data$BEPTA,na.rm=TRUE)
global_data[1:5] %>% select(q0002,q0003,BEPTA,country) %>% group_by(country) %>% summarise(q0002=mean(q0002),q0003=mean(q0003),BEPTA=mean(BEPTA))
global_data[1:5] %>%group_by(country) %>% summarise(q0002=mean(q0002),q0003=mean(q0003),BEPTA=mean(BEPTA))
global_data %>%group_by(country) %>% summarise(q0002=mean(q0002),q0003=mean(q0003),BEPTA=mean(BEPTA))
global_data %>%group_by(country) %>% summarise(q0002=median(q0002),q0003=median(q0003),BEPTA=median(BEPTA))
global_data %>%group_by(country) %>% summarise(q0002=median(q0002,na.rm=TRUE),q0003=median(q0003),BEPTA=median(BEPTA))
global_data %>%group_by(country) %>% summarise(q0002=median(q0002),q0003=median(q0003,na.rm=TRUE),BEPTA=median(BEPTA,na.rm=TRUE))
global_data %>%group_by(country) %>% summarise(q0003=median(q0003,na.rm=TRUE),BEPTA=median(BEPTA,na.rm=TRUE))
global_data %>%group_by(country) %>% summarise(BEPTA=median(BEPTA,na.rm=TRUE))
6428+1927
1214+56+1527+359+1776+817+1100+580
1214+56+1527+359+1776+817+1100+580+1927
1214+56+1527+359+1776+817+1100+580+621
1214+56+1527+359+1776+817+1100+580+621+1927
View(hear3plot)
all_RN_data <- rbind.fill(UK_RN_data,UK_state_RN_data)
all_RN_data <- rbind.fill(all_RN_data,London_RN_data)
all_RN_data <- rbind.fill(all_RN_data,AUS_RN_data)
all_RN_data <- rbind.fill(all_RN_data,AUS_state_RN_data)
all_RN_data <- rbind.fill(all_RN_data,CAN_RN_data)
all_RN_data <- rbind.fill(all_RN_data,CAN_state_RN_data)
all_RN_data <- rbind.fill(all_RN_data,US_RN_data)
all_RN_data <- rbind.fill(all_RN_data,US_state_RN_data)
#Remove subjects under 60 years old
all_RN_data <- all_RN_data[!(all_RN_data$q0003==1),]
all_RN_data <- rbind.fill(UK_RN_data,UK_state_RN_data)
all_RN_data <- rbind.fill(all_RN_data,London_RN_data)
all_RN_data <- rbind.fill(all_RN_data,AUS_RN_data)
all_RN_data <- rbind.fill(all_RN_data,AUS_state_RN_data)
all_RN_data <- rbind.fill(all_RN_data,CAN_RN_data)
all_RN_data <- rbind.fill(all_RN_data,CAN_state_RN_data)
all_RN_data <- rbind.fill(all_RN_data,US_RN_data)
all_RN_data <- rbind.fill(all_RN_data,US_state_RN_data)
all_RN_data$q0003==1)
all_RN_data$q0003==1
sum(all_RN_data$q0003==1)
table(all_RN_data$q0003==1)
table(all_RN_data$q0003)
table(global_data$q0003)
global_data <- rbind.fill(AUS_data,CAN_data)
global_data <- rbind.fill(global_data,UK_data)
global_data <- rbind.fill(global_data,US_data)
table(global_data$q0003)
AUS_data<- read.csv("C:/Users/mkeomec/Documents/GitHub/eHearing/AF_AU_UNI_Survey+HT_12.13.17.csv", header=T, na.strings=c("#NULL!",'90NR'))
CAN_data<- read.csv("C:/Users/mkeomec/Documents/GitHub/eHearing/AF_CAN_InPerson_AllSubs_Survey+Audio_CLEAN_07.25.2018.csv", header=T, na.strings=c("#NULL!",'90NR'))
UK_data<- read.csv("C:/Users/mkeomec/Documents/GitHub/eHearing/AF_UK_InPerson_AllSurvey+AllAudios_CLEAN_7.26.18.csv", header=T, na.strings=c("#NULL!",'90NR'))
US_data<- read.csv("C:/Users/mkeomec/Documents/GitHub/eHearing/AF_US_UNI_AllSubsSurvey+Audio_2.20.18.csv", header=T, na.strings=c("#NULL!",'90NR'))
table(AUS_data$q0003)
table(CAN_data$q0003)
table(UK_data$q0003)
table(US_data$q0003)
#UK_RN_data<- read.spss("C:/Users/cwbishop/Documents/dropbox/Dropbox/Work/UW BandBlab/Studies/eHearing/U.K. eHearing Study - Online Panel Survey.sav", to.data.frame=TRUE, use.value.labels=FALSE)
UK_RN_data<- read.spss("C:/Users/mkeomec/Dropbox/eHearing manuscript/U.K. eHearing Study - Online Panel Survey.sav", to.data.frame=TRUE, use.value.labels=FALSE)
table(UK_RN_data$q0003)
table(UK_state_RN_data$q0003)
table(all_RN_data$q0003)
table(London_RN_data$q0003)
table(AUS_RN_data$q0003)
table(AUS_state_RN_data$q0003)
table(CAN_RN_data$q0003)
#Ontario- Target 2000 respondents. Info on Toronto or other areas of Ontario
# Dataset omits location
# CAN_RN_data<- read.spss("C:/Users/cwbishop/Documents/dropbox/Dropbox/Work/UW BandBlab/Studies/eHearing/2018 SPSS datasets/eHearing Study - CanadaPanel.sav", to.data.frame=TRUE,use.value.labels=FALSE)
CAN_RN_data<- read.spss("C:/Users/mkeomec/Dropbox/eHearing manuscript/eHearing Study - CanadaPanel.sav", to.data.frame=TRUE,use.value.labels=FALSE)
CAN_RN_data$q0001_new <- NA
CAN_RN_data <- CAN_RN_data[,c(1:10,1522,11:1521)]
names(CAN_RN_data) <- names(AUS_state_RN_data[1:1522])
CAN_RN_data$country_id <- 'CAN'
CAN_RN_data$state_id <- 'Ontario'
table(CAN_RN_data$q0003)
UK_RN_data<- read.spss("C:/Users/mkeomec/Dropbox/eHearing manuscript/U.K. eHearing Study - Online Panel Survey.sav", to.data.frame=TRUE, use.value.labels=FALSE)
test <- attr(UK_RN_data$q0001,'value.labels')
UK_RN_data$q0001 <- names(test)[UK_RN_data$q0001]
UK_RN_data$country_id <- 'UK'
UK_RN_data$region_id <- UK_RN_data$q0001
#UK_state_RN_data <- read.spss("C:/Users/mkeomec/eHearing manuscript//UK England Online.sav", to.data.frame=TRUE,use.value.labels=FALSE)
UK_state_RN_data <- read.spss("C:/Users/mkeomec/Dropbox/eHearing manuscript/UK England Online.sav", to.data.frame=TRUE,use.value.labels=FALSE)
test <- attr(UK_state_RN_data$q0001,'value.labels')
UK_state_RN_data$q0001 <- names(test)[UK_state_RN_data$q0001]
UK_state_RN_data$country_id <- 'UK'
UK_state_RN_data$region_id <- 'England'
UK_state_RN_data$state_id <- UK_state_RN_data$q0001
# London_RN_data <- read.spss("C:/Users/cwbishop/Documents/dropbox/Dropbox/Kelly and Michael/UK London Online.sav", to.data.frame=TRUE,use.value.labels=FALSE)
London_RN_data <- read.spss("C:/Users/mkeomec/Dropbox/eHearing manuscript/UK London Online.sav", to.data.frame=TRUE,use.value.labels=FALSE)
test <- attr(London_RN_data$q0001,'value.labels')
London_RN_data$q0001 <- names(test)[London_RN_data$q0001]
London_RN_data$country_id <- 'UK'
UK_state_RN_data$region_id <- 'England'
London_RN_data$city_id <-London_RN_data$q0001
# AUS_RN_data <- read.spss("C:/Users/cwbishop/Documents/dropbox/Dropbox/Work/UW BandBlab/Studies/eHearing/2018 SPSS datasets/eHearing Study-Australia-Panel.sav", to.data.frame=TRUE,use.value.labels=FALSE)
AUS_RN_data <- read.spss("C:/Users/mkeomec/Dropbox/eHearing manuscript/eHearing Study-Australia-Panel.sav", to.data.frame=TRUE,use.value.labels=FALSE)
test <- attr(AUS_RN_data$q0001,'value.labels')
AUS_RN_data$q0001 <- names(test)[AUS_RN_data$q0001]
AUS_RN_data$country_id <- 'AUS'
AUS_RN_data$state_id <- AUS_RN_data$q0001
# AUS_state_RN_data <- read.spss("C:/Users/cwbishop/Documents/dropbox/Dropbox/Work/UW BandBlab/Studies/eHearing/2018 SPSS datasets/eHearing Study - NSW - Panel.sav", to.data.frame=TRUE,use.value.labels=FALSE)
AUS_state_RN_data <- read.spss("C:/Users/mkeomec/Dropbox/eHearing manuscript/eHearing Study - NSW - Panel.sav", to.data.frame=TRUE,use.value.labels=FALSE)
test <- attr(AUS_state_RN_data$q0001,'value.labels')
AUS_state_RN_data$q0001 <- names(test)[AUS_state_RN_data$q0001]
AUS_state_RN_data$country_id <- 'AUS'
AUS_state_RN_data$state_id <- 'NSW'
AUS_state_RN_data$city_id <- AUS_state_RN_data$q0001
AUS_state_RN_data$city_id[which(AUS_state_RN_data$city_id=='All other')] <- 'Other AUS NSW'
#Ontario- Target 2000 respondents. Info on Toronto or other areas of Ontario
# Dataset omits location
# CAN_RN_data<- read.spss("C:/Users/cwbishop/Documents/dropbox/Dropbox/Work/UW BandBlab/Studies/eHearing/2018 SPSS datasets/eHearing Study - CanadaPanel.sav", to.data.frame=TRUE,use.value.labels=FALSE)
CAN_RN_data<- read.spss("C:/Users/mkeomec/Dropbox/eHearing manuscript/eHearing Study - CanadaPanel.sav", to.data.frame=TRUE,use.value.labels=FALSE)
CAN_RN_data$q0001_new <- NA
CAN_RN_data <- CAN_RN_data[,c(1:10,1522,11:1521)]
names(CAN_RN_data) <- names(AUS_state_RN_data[1:1522])
CAN_RN_data$country_id <- 'CAN'
CAN_RN_data$state_id <- 'Ontario'
# CAN_state_RN_data<- read.spss("C:/Users/cwbishop/Documents/dropbox/Dropbox/Work/UW BandBlab/Studies/eHearing/2018 SPSS datasets/eHearing Study of Alberta_BC_Quebec_Other_Canada_Panel - 2.sav", to.data.frame=TRUE,use.value.labels=FALSE)
CAN_state_RN_data<- read.spss("C:/Users/mkeomec/Dropbox/eHearing manuscript/eHearing Study of Alberta_BC_Quebec_Other_Canada_Panel - 2.sav", to.data.frame=TRUE,use.value.labels=FALSE)
test <- attr(CAN_state_RN_data$q0001,'value.labels')
CAN_state_RN_data$q0001 <- names(test)[CAN_state_RN_data$q0001]
names(CAN_state_RN_data) <- names(AUS_state_RN_data[1:1522])
CAN_state_RN_data$country_id <- 'CAN'
CAN_state_RN_data$state_id <- CAN_state_RN_data$q0001
CAN_state_RN_data$state_id[which(CAN_state_RN_data$state_id=='Other')] <- 'Other CAN'
#names(CAN_RN_data) <- names(CAN_state_RN_data[-11])
# Dataset omits location
# US_RN_data <- read.spss("C:/Users/cwbishop/Documents/dropbox/Dropbox/Work/UW BandBlab/Studies/eHearing/2018 SPSS datasets/eHearing Study - USA - Panel.sav", to.data.frame=TRUE,use.value.labels=FALSE)
US_RN_data <- read.spss("C:/Users/mkeomec/Dropbox/eHearing manuscript/eHearing Study - USA - Panel.sav", to.data.frame=TRUE,use.value.labels=FALSE)
US_RN_data$q0001_new <- NA
US_RN_data <- US_RN_data[,c(1:10,1522,11:1521)]
names(US_RN_data) <- names(CAN_state_RN_data[1:1522])
US_RN_data$country_id <- 'US'
# Dataset omits location
# US_state_RN_data <- read.spss("C:/Users/cwbishop/Documents/dropbox/Dropbox/Work/UW BandBlab/Studies/eHearing/2018 SPSS datasets/eHearing Study - USA WA - Panel.sav", to.data.frame=TRUE,use.value.labels=FALSE)
US_state_RN_data <- read.spss("C:/Users/mkeomec/Dropbox/eHearing manuscript/eHearing Study - USA WA - Panel.sav", to.data.frame=TRUE,use.value.labels=FALSE)
US_state_RN_data$q0001_new <- NA
US_state_RN_data <- US_state_RN_data[,c(1:10,1523,11:1522)]
#q0003  in "USA WA" Research now dataset is are you a current resident of WA. Remove this Question
US_state_RN_data <- US_state_RN_data[-13]
names(US_state_RN_data) <- names(CAN_state_RN_data[1:1522])
US_state_RN_data$country_id <- 'US'
US_state_RN_data$state_id <- 'WA'
all_RN_data <- rbind.fill(UK_RN_data,UK_state_RN_data)
all_RN_data <- rbind.fill(all_RN_data,London_RN_data)
all_RN_data <- rbind.fill(all_RN_data,AUS_RN_data)
all_RN_data <- rbind.fill(all_RN_data,AUS_state_RN_data)
all_RN_data <- rbind.fill(all_RN_data,CAN_RN_data)
all_RN_data <- rbind.fill(all_RN_data,CAN_state_RN_data)
all_RN_data <- rbind.fill(all_RN_data,US_RN_data)
all_RN_data <- rbind.fill(all_RN_data,US_state_RN_data)
table(all_RN_data$q0003)
#Remove subjects under 60 years old
all_RN_data <- all_RN_data[!(all_RN_data$q0003==1),]
table(all_RN_data$q0003)
global_data <- all_RN_data
radarplot<-function(data){
data<- data[,c('q0041_0001','q0041_0002','q0041_0003','q0041_0004','q0041_0005','q0041_0006','q0041_0007','q0041_0008','q0041_0009','q0041_0010','q0041_0011','q0041_0012','q0041_0013','q0041_0014')]
data$Q41_1 <- data$q0041_0001
data$Q41_2 <- data$q0041_0002
#data$Q41_2 <- NA
#data$Q41_2[which(data$q0041_0002=="TV ads"|data$q0041_0006=="TV ads")] <-"TV ads"
data$Q41_3 <- data$q0041_0003
data$Q41_4 <- data$q0041_0004
data$Q41_5 <- data$q0041_0005
data$Q41_6 <- data$q0041_0006
#data$Q41_6 <- NA
#data$Q41_6[which(data$q0041_0002=="Pamphlets that you see in your doctor or other healthcare provider's office"|data$q0041_0006=="Pamphlets that come to you see in your doctor or other healtchcare provider's office")] <- "Pamphlets in HCP Office"
data$Q41_7 <- data$q0041_0007
data$Q41_8 <- data$q0041_0008
data$Q41_9 <- data$q0041_0009
data$Q41_10 <- data$q0041_0010
data$Q41_11 <- data$q0041_0011
data$Q41_12 <- data$q0041_0012
#data$Q41_12 <- NA
#data$Q41_12[which(!is.na(data$q0041_0012))] <- "Hearing Loss Associations"
data$Q41_13 <- data$q0041_0013
data$Q41_14 <- data$q0041_0014
data<-data[,15:28]
radar_plot_data<-as.data.frame(t((apply(data,2,function(x)table(x)))))
radar_plot_data<-(radar_plot_data/nrow(data))*100
radar_plot_data<-rbind(rep(100,14) , rep(0,14) , radar_plot_data)
names(radar_plot_data) <- c('Doctor','Pamphlets in HCP Office', 'Radio Ads', 'Newspaper', 'Mailed Pamphlets','TV Ads', 'University Websites', 'Internet Ads', 'Government Websites', 'Medical Websites', 'Friends and Family', 'Hearing Loss Associations/Charities', 'Ads in Public Places', 'Public Libraries')
radar_plot_data<- radar_plot_data[c(1,2,10,7,9,12,14,3,4,5,6,8,13,11)]
return(radar_plot_data)
}
global_radar_plot <- radarplot(global_data)
US_data <- global_data[which(global_data$country=="US"),]
UK_data <- global_data[which(global_data$country=="UK"),]
CAN_data <- global_data[which(global_data$country=="CAN"),]
AUS_data <- global_data[which(global_data$country=="AUS"),]
table(global_data$country,global_data$q0002)
table(global_data$region_id,global_data$q0002)
table(global_data$state_id,global_data$q0002)
grid.table(table(global_data$state_id,global_data$q0002))
grid.table(table(global_data$state_id,global_data$q0002))
table(global_data$country,global_data$q0002)
table(global_data$country,global_data$q0003)
global_data %>%group_by(country) %>% summarise(BEPTA=median(BEPTA,na.rm=TRUE))
### Research Now - Online
global_data %>%group_by(country_id) %>% summarise(BEPTA=median(BEPTA,na.rm=TRUE))
table(global_data$region_id,global_data$q0003)
table(global_data$state_id,global_data$q0003)
table(global_data$city_id,global_data$q0002)
table(global_data$city_id,global_data$q0003)
global_data %>%group_by(country) %>% summarise(BEPTA=IQR(BEPTA,na.rm=TRUE))
global_data <- rbind.fill(AUS_data,CAN_data)
global_data <- rbind.fill(global_data,UK_data)
global_data <- rbind.fill(global_data,US_data)
AUS_data<- read.csv("C:/Users/mkeomec/Documents/GitHub/eHearing/AF_AU_UNI_Survey+HT_12.13.17.csv", header=T, na.strings=c("#NULL!",'90NR'))
CAN_data<- read.csv("C:/Users/mkeomec/Documents/GitHub/eHearing/AF_CAN_InPerson_AllSubs_Survey+Audio_CLEAN_07.25.2018.csv", header=T, na.strings=c("#NULL!",'90NR'))
UK_data<- read.csv("C:/Users/mkeomec/Documents/GitHub/eHearing/AF_UK_InPerson_AllSurvey+AllAudios_CLEAN_7.26.18.csv", header=T, na.strings=c("#NULL!",'90NR'))
US_data<- read.csv("C:/Users/mkeomec/Documents/GitHub/eHearing/AF_US_UNI_AllSubsSurvey+Audio_2.20.18.csv", header=T, na.strings=c("#NULL!",'90NR'))
UK_data <- data_prep(UK_data)
CAN_data <- data_prep(CAN_data)
AUS_data <- data_prep(AUS_data)
US_data <- data_prep(US_data)
# Run regression model seclection on all countries data
# Combine all country's datasets
AUS_data$country <- 'AUS'
US_data$country <- 'US'
UK_data$country <- 'UK'
CAN_data$country <- 'CAN'
global_data <- rbind.fill(AUS_data,CAN_data)
global_data <- rbind.fill(global_data,UK_data)
global_data <- rbind.fill(global_data,US_data)
global_data %>%group_by(country) %>% summarise(BEPTA=IQR(BEPTA,na.rm=TRUE))
median(UK_data$BEPTA)
median(UK_data$BEPTA,na.rm=TRUE)
median(CAN_data$BEPTA,na.rm=TRUE)
median(AUS_data$BEPTA,na.rm=TRUE)
IQR(AUS_data$BEPTA,na.rm=TRUE)
